---
title: "MyLab2"
author: "Дроздовская Полина"
date: "2024-04-01"
output: html_document
---

## Вариант 2

$$\begin{cases}
      \min{F(x)=10x_1+4x_2+8x_3+6x_4+2x_5+3x_6+8x_7+2x_8+6x_9+6x_{10}}\\
      x_1+x_2+x_3+x_4\leq400\\
      x_5+x_6\leq800\\
      x_7+x_8+x_9+x_{10}\leq600\\
      \sum_{i=1}^{10} x_i\geq1200\\
      \forall{i}: 0\leq x_i\leq700
\end{cases}\,$$

#### Численное решение:

#### lpSolve

Задаём коэффициенты целевой функции:

```{r}
library(lpSolve)
rm(list=ls())

Fun <- c(10, 4, 8, 6, 2, 3, 8, 2, 6, 6)
```

Ограничения задаются в виде матрицы коэффициентов:

```{r}
A <- rbind(
  c(1, 1, 1, 1, 0, 0, 0, 0, 0, 0), 
  c(0, 0, 0, 0, 1, 1, 0, 0, 0, 0), 
  c(0, 0, 0, 0, 0, 0, 1, 1, 1, 1),
  c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1),
  diag(10))
```

Правые части и знаки ограничений задаются отдельно:

```{r}
B <- c(400, 800, 600, 1200)
CD <- c("<=", "<=", "<=", ">=")

B <- c(B, replicate(10, 700))
CD <- c(CD, replicate(10, "<="))
```

Для решения вызываетя процедура **lp**:

```{r}
optimum <- lp(
  direction = "min",
  objective.in = Fun,
  const.mat = A,
  const.dir = CD,
  const.rhs = B,
  compute.sens = TRUE)
optimum
```

Макисмальное значение целевой функции достигается при следующих значениях переменных:

```{r}
optimum$solution
which(optimum$solution>0)
```

#### lpSolveAPI

Создать объект модели задачи линейного программирования с 10 переменными и 0 ограничений (будут добавлены позднее).

```{r}
library(lpSolveAPI)
lprob <- make.lp(0, 10)
```

Далее выбирается тип оптимизации, в данном случае минимизация. Вывод функции перенаправляется в переменную заглушку, чтобы отменить печать информации на экран.

```{r}
stub <- lp.control(lprob, sense = "min")
rm(stub)
```

Далее задаются ограничения. Коэффициенты в функция ограничения задаются с помощью $c(a_1,a_2,a_3,...,a_n)\implies a_1x_1+a_2x_2+a_3x_3+...a_nx_n$. По умолчанию на переменные накладывается условие $\forall{i}: x_i\geq0$

```{r}
add.constraint(lprob, c(1, 1, 1, 1, 0, 0, 0, 0, 0, 0), "<=", 400)
add.constraint(lprob, c(0, 0, 0, 0, 1, 1, 0, 0, 0, 0), "<=", 800)
add.constraint(lprob, c(0, 0, 0, 0, 0, 0, 1, 1, 1, 1), "<=", 600)
add.constraint(lprob, c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1), ">=", 1200)
add.constraint(lprob, c(1, 0, 0, 0, 0, 0, 0, 0, 0, 0), "<=", 700)
add.constraint(lprob, c(0, 1, 0, 0, 0, 0, 0, 0, 0, 0), "<=", 700)
add.constraint(lprob, c(0, 0, 1, 0, 0, 0, 0, 0, 0, 0), "<=", 700)
add.constraint(lprob, c(0, 0, 0, 1, 0, 0, 0, 0, 0, 0), "<=", 700)
add.constraint(lprob, c(0, 0, 0, 0, 1, 0, 0, 0, 0, 0), "<=", 700)
add.constraint(lprob, c(0, 0, 0, 0, 0, 1, 0, 0, 0, 0), "<=", 700)
add.constraint(lprob, c(0, 0, 0, 0, 0, 0, 1, 0, 0, 0), "<=", 700)
add.constraint(lprob, c(0, 0, 0, 0, 0, 0, 0, 1, 0, 0), "<=", 700)
add.constraint(lprob, c(0, 0, 0, 0, 0, 0, 0, 0, 1, 0), "<=", 700)
add.constraint(lprob, c(0, 0, 0, 0, 0, 0, 0, 0, 0, 1), "<=", 700)
```

Задание целевой функции. Объект модели можно конструировать в произвольном порядке:

```{r}
set.objfn(lprob, c(10, 4, 8, 6, 2, 3, 8, 2, 6, 6))
lprob
```

Далее необходимо решить систему:

```{r}
status_code <- solve(lprob)
```

Наилучшее значение целевой функции:

```{r}
get.objective(lprob)
```

Значение переменных, при которых дистигнуто максимальное значение целевой функции:

```{r}
get.variables(lprob)
```

#### Анализ чувствительности

Анализ чувствительности применим только к задаче в действительных числах. Исходная целевая функция $F=10x_1+4x_2+8x_3+6x_4+2x_5+3x_6+8x_7+2x_8+6x_9+6x_{10}$. Для анализа чувствительности целевой функции используется функция **get.sensitivity.obj**.

```{r}
get.sensitivity.obj(lprob)
```

Полученные значения означают, что при измениении значения $x_1\in(2,1e+30)$ или $x_2\in(2,1e+30)$ точка соовтетствующая лучшему значению целевой функции не изменится.

Для анализа чувствительности ограничений применяется функция **get.sensitivity.rhs**.

```{r}
get.sensitivity.rhs(lprob)
```

```{r}
which(get.sensitivity.rhs(lprob)$duals>0)
```

Рассмотрим первое ограничение $x_1+x_2+x_3+x4\leq400$. Значение $\xi_1=0$ показывает насколько изменится целевая функция, если значение ограничения увеличится на одну единицу. Значение $xi$ ненулевое, только если ограничение активно. $\xi$ можно интерпретировать как частную произовдную целевой фунцкии по правой части неравенстра ограничения. $\xi_1=\frac{\partial F}{\partial B_1}$. Следовательно, при изменении ограничения $\xi_i$ в пределах от $\xi_{from}$ до $\xi_{till}$ значение целевой функции изменится как $F=F_0+\Delta B_i \xi_i$

Значение $\xi_i$ дает очень хорошее представление о том, сколько стоит это ограничение. Если значение $\xi_i$ большое, то это ограничение сильно влияет на целевую функцию. Небольшие изменения ограничения (ослабление) позволит значительно улучшить значение целевой функции. Также имеет значение знак $\xi_i$. Положительное значение означает, что по мере увеличения ограничения значение целевой функции будет больше, а по мере того, как оно становится более отрицательным, значение целевой функции будет меньше.

Аналогично для **lpSolve** используются следующие функции для анализа коэффициентов целевой функции

```{r}
optimum$sens.coef.from
optimum$sens.coef.to
```

и для анализа ограничений

```{r}
optimum$duals
optimum$duals.from
optimum$duals.to
```

## Ответы на вопросы по линейному программированию (ЛП):

#### 1. Стандартная форма модели ЛП:

Целевая функция должна быть максимизирована. Если исходная задача на минимизацию, то её можно преобразовать, изменив знаки коэффициентов целевой функции. Ограничения представлены в виде неравенств типа “меньше или равно” (`<=`). Переменные должны быть неотрицательными.

-   **Целевая функция**: максимизировать или минимизировать линейную функцию.
-   **Ограничения**: система линейных неравенств со знаком `<=`.
-   **Переменные**: неотрицательные `>= 0` .

#### 2. Чем отличаются условия допустимости и оптимальности для функций минимизации и максимизации?

**Условия допустимости** определяют набор решений, которые удовлетворяют всем ограничениям задачи ЛП. Эти условия *одинаковы для задач минимизации и максимизации* и включают в себя соответствие ограничениям и неотрицательность переменных.

**Условия оптимальности** указывают на то, какое из допустимых решений является наилучшим с точки зрения целевой функции. Для задачи максимизации оптимальным будет решение, при котором целевая функция достигает максимального значения, а для задачи минимизации — минимального. В контексте теоремы двойственности в линейном программировании, оптимальное решение прямой задачи (например, максимизации) соответствует оптимальному решению двойственной задачи (минимизации), и наоборот. Это означает, что если вы нашли оптимальное решение для задачи максимизации, то соответствующее решение двойственной задачи минимизации также будет оптимальным, и эти решения будут равны по значению целевой функции.

Таким образом, хотя условия *допустимости остаются неизменными*, *условия оптимальности меняются в зависимости от того, максимизируется или минимизируется целевая функция*. Эти условия помогают определить, какие решения являются допустимыми и какое из них является наилучшим в рамках поставленной задачи ЛП.

**Минимизация:**

-   **Допустимость:** все ограничения выполняются.
-   **Оптимальность:** целевая функция достигает минимального значения.

**Максимизация:**

-   **Допустимость:** все ограничения выполняются.

-   **Оптимальность:** целевая функция достигает максимального значения.

#### 3. Для чего вводятся остаточные и избыточные переменные?

Остаточные и избыточные переменные вводятся в задачи линейного программирования (ЛП) для преобразования ограничений в стандартную форму, что необходимо для применения симплекс-метода. Вот основные цели их использования:

1.  **Остаточные переменные** добавляются к ограничениям типа “меньше или равно” (`<=`), чтобы преобразовать их в уравнения. Это позволяет каждому ограничению иметь точное равенство, что **упрощает поиск оптимального решения**.

2.  **Избыточные переменные** вычитаются из ограничений типа “больше или равно” (`>=`), чтобы также преобразовать их в уравнения. Эти переменные показывают избыток над установленным минимумом в ограничениях.

3.  В некоторых случаях также вводятся **искусственные переменные**, чтобы начать поиск оптимального решения с допустимого базисного решения, если остаточных и избыточных переменных недостаточно для этого.

#### 4. Какую информацию можно получить, анализируя значения дополнительных переменных?

Анализируя значения дополнительных переменных в задачах линейного программирования (ЛП), можно получить важную информацию о решении и ограничениях задачи:

1.  **Остаточные переменные**: Если остаточная переменная в оптимальном решении имеет значение, отличное от нуля, это указывает на то, что соответствующее ограничение не является активным, то есть решение находится внутри допустимой области, а не на её границе. Значение остаточной переменной показывает, насколько можно изменить правую часть ограничения, не влияя на оптимальность текущего решения.

2.  **Избыточные переменные**: Ненулевое значение избыточной переменной свидетельствует о том, что решение находится на границе допустимой области для ограничения типа `>=`. Это также может указывать на избыток ресурса или ограничения.

3.  **Двойственные значения (duals)**: Двойственные значения, связанные с каждым ограничением в ЛП, показывают изменение целевой функции при изменении правой части ограничения на одну единицу. Если двойственное значение равно нулю, это означает, что ограничение не влияет на оптимальное значение целевой функции.

4.  **Искусственные переменные**: Если после завершения симплекс-метода искусственная переменная остаётся в базисе с ненулевым значением, это указывает на то, что задача не имеет допустимых решений.

Таким образом, анализируя значения дополнительных переменных, можно оценить влияние ограничений на решение задачи, определить, какие ресурсы являются избыточными или дефицитными, и как изменение условий задачи может повлиять на оптимальное решение.

$F=F_0+\Delta B_i \xi_i$

#### 5. В чём особенность применения M-метода и двухэтапного метода?

Особенности применения M-метода и двухэтапного метода в линейном программировании (ЛП) заключаются в следующем:

**M-метод**:

-   Используется для решения задач ЛП, где невозможно найти начальное допустимое базисное решение с помощью обычного симплекс-метода.

-   Вводит искусственные переменные в систему ограничений и добавляет их в целевую функцию *с очень большими штрафными коэффициентами (M),* чтобы обеспечить начальное допустимое базисное решение.

-   Цель M-метода — минимизировать сумму искусственных переменных, умноженных на M, чтобы исключить искусственные переменные из базисного решения.

-   После того как искусственные переменные исключены из базиса и их значения становятся равными нулю, задача решается обычным симплекс-методом.

**Двухэтапный метод**:

-   Также применяется, когда нет очевидного начального допустимого базисного решения.

-   На первом этапе минимизируется сумма искусственных переменных, чтобы найти допустимое базисное решение, *не вводя при этом большие штрафные коэффициенты*.

-   На втором этапе, после удаления искусственных переменных из базиса, решается исходная задача ЛП с использованием полученного допустимого базисного решения.

Оба метода позволяют преобразовать задачу ЛП таким образом, чтобы можно было применить симплекс-метод, но они используют разные подходы для обработки искусственных переменных и начального поиска допустимого решения.

#### 6. **Укажите особые случаи применения симплекс-метода. Чем они вызваны?**

Особые случаи применения симплекс-метода включают:

1.  **Альтернативные оптимальные решения**: Когда существует более одного оптимального решения задачи ЛП. Это происходит, когда целевая функция параллельна одной из граней допустимой области.

2.  **Неограниченные решения**: Возникают, когда допустимая область не ограничена в направлении улучшения целевой функции, что означает, что можно достичь бесконечно большого значения целевой функции.

3.  **Отсутствие допустимых решений**: Когда система ограничений такова, что не существует ни одной точки, удовлетворяющей всем ограничениям одновременно.

Эти случаи вызваны особенностями задачи ЛП, такими как структура ограничений и форма целевой функции.

#### **7. Объясните, из-за чего возникает необходимость использования искусственных переменных при поиске начального базового решения?**

Искусственные переменные используются в линейном программировании для нахождения начального допустимого базисного решения, когда прямое применение симплекс-метода невозможно. Вот основные причины их использования:

1.  **Ограничения типа равенства** (**`=`**): Если в задаче ЛП присутствуют ограничения равенства, то для них не существует естественных остаточных переменных, которые могли бы быть использованы для формирования начального базиса.

2.  **Отрицательные свободные члены**: Если в системе ограничений есть отрицательные свободные члены, то простое добавление остаточных переменных не приведёт к допустимому начальному решению.

3.  **Ограничения типа `>=`**: Для таких ограничений избыточные переменные вычитаются, что также не позволяет сразу получить допустимое базисное решение.

Искусственные переменные вводятся в систему ограничений и добавляются в целевую функцию с большими штрафными коэффициентами (M), чтобы обеспечить начальное допустимое базисное решение. В процессе решения задачи методом искусственного базиса эти переменные должны быть исключены из базиса, обращаясь в нуль, что позволяет перейти к решению исходной задачи ЛП.
